CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(hibus C)

SET(PROJECT_NAME "hibus")
SET(PROJECT_VERSION "0.9")

ADD_DEFINITIONS(-O2 -Wall -Werror --std=gnu99 -g3 -Wmissing-declarations)

OPTION(BUILD_LUA "build Lua plugin" ON)
OPTION(BUILD_EXAMPLES "build examples" ON)

SET(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")
SET(HIBUS_UNIX_SOCKET "/var/run/hibus.sock")
SET(HIBUS_WEB_SOCKET_PORT 7700)
SET(HIBUS_MAX_MSGLEN 1048576)

ADD_DEFINITIONS( -DHIBUS_UNIX_SOCKET="${HIBUS_UNIX_SOCKET}")
ADD_DEFINITIONS( -DHIBUS_WEB_SOCKET_PORT="${HIBUS_WEB_SOCKET_PORT}")
ADD_DEFINITIONS( -DHIBUS_MAX_MSGLEN=${HIBUS_MAX_MSGLEN})

ADD_SUBDIRECTORY(src)

# Packing stuff
SET(CPACK_PACKAGE_VENDOR "FMSoft")
SET(CPACK_PACKAGE_NAME ${PROJECT_NAME})
SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "The data bus server, library, and utilities for device side of HybridOS")
SET(CPACK_SOURCE_PACKAGE_FILE_NAME "${PROJECT_NAME}-${PROJECT_VERSION}")
SET(CPACK_SOURCE_GENERATOR "TGZ")
SET(CPACK_SOURCE_IGNORE_FILES
      "/auto/;/cmake/;/.svn/;/.git/;/.bzr/;/CMakeFiles/;/_CPack_Packages/;CMakeCache.txt$;
      ~$;.swp$;.cmake$;
      ${CPACK_SOURCE_IGNORE_FILES}")

INCLUDE(CPack)
